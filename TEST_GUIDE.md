# Terminal 1 - MongoDB (if local)
mongod

# Terminal 2 - Python Service
cd service
pip install -r requirements.txt --break-system-packages
python main.py
# Should show: "Application startup complete" on port 8000

# Terminal 3 - Node Server
cd server
npm install
npm start
# Should show: "Server running on port 5000" and "MongoDB connected"

# Terminal 4 - Client (Candidate)
cd client
npm install
npm run dev
# Should open on http://localhost:5173

# Terminal 5 - Admin
cd admin
npm install
npm run dev
# Should open on http://localhost:5174
```

---

## **Testing Flow - Follow This Exact Order**

---

## **PART 1: CANDIDATE PORTAL TESTING** üéØ

### **Test 1: Signup & Email Verification**
```
‚úÖ Steps:
1. Go to http://localhost:5173
2. Click "Sign up"
3. Fill: Name, Email, Password
4. Click "Sign Up"

‚úÖ Expected:
- Message: "User created. Please verify your email."
- Check your email for OTP

5. Enter OTP
6. Click "Verify OTP"

‚úÖ Expected:
- Message: "Email verified successfully"
- Redirects to login page
```

---

### **Test 2: Candidate Login**
```
‚úÖ Steps:
1. Go to login page
2. Enter email & password
3. Click "Login"

‚úÖ Expected:
- Successfully logs in
- Redirects to /candidate/dashboard
- Shows your name in header
```

---

### **Test 3: Forgot Password Flow** üÜï
```
‚úÖ Steps:
1. Go to login page
2. Click "Forgot password?" link

‚úÖ Expected:
- Shows reset password screen
- Has KeyRound icon

3. Enter your email
4. Click "Send Reset Code"

‚úÖ Expected:
- Message: "Reset code sent to your email"
- Check email for 6-digit OTP

5. Enter OTP
6. Enter new password (min 6 chars)
7. Click "Reset Password"

‚úÖ Expected:
- Message: "Password reset successful!"
- Auto redirects to login after 2 seconds

8. Login with NEW password

‚úÖ Expected:
- Login works with new password
```

---

### **Test 4: Resume Upload - Initial State**
```
‚úÖ Steps:
1. After login, check dashboard
2. Look at Profile section (left side)

‚úÖ Expected - AI DISCLAIMER VISIBLE:
- Yellow box with warning icon
- Text: "AI-Generated Information"
- Text: "Profile information is automatically extracted using AI. 
         Please review and verify all details for accuracy."

3. No jobs should show match scores yet (or shows null/gray)
```

---

### **Test 5: Resume Upload - Process**
```
‚úÖ Steps:
1. Click "Choose PDF or DOCX file"
2. Select a resume (PDF or DOCX)

‚úÖ Expected:
- Shows filename below button
- Example: "Selected: MyResume.pdf"

3. Click "Upload Resume"

‚úÖ Expected IMMEDIATELY:
- Button shows "Uploading..."
- Button is disabled

‚úÖ Expected AFTER UPLOAD (within 5 seconds):
- Blue banner appears at top:
  "Processing your resume and calculating match scores... Please wait."
- Loader/spinner icon visible
```

---

### **Test 6: Profile Data Extraction (OCR Check)** ‚≠ê CRITICAL
```
‚úÖ Steps:
1. Wait 10-20 seconds after upload completes
2. Check Profile section

‚úÖ Expected - Check ALL fields are populated:
- Skills: Should show comma-separated skills
  Example: "Python, JavaScript, React, Node.js, MongoDB"
  
- Experience: Should show work history (first 200 chars if long)
  Should NOT be cut off mid-sentence
  Should show company names and roles
  
- Education: Should show degree, college, year
  Example: "B.Tech Computer Science | IIT Delhi | 2020"
  
- Years of Experience: Should show number
  Example: "5 years"

‚úÖ VERIFY OCR QUALITY:
‚ñ° Skills extracted correctly (check against actual resume)
‚ñ° Experience text is complete (not truncated weird)
‚ñ° Education detected properly
‚ñ° Years of experience calculated correctly

‚úÖ If ANY field says "Not specified":
- This means OCR failed for that section
- Check the actual resume - does it have that info?
- Check Python service logs for errors
```

---

### **Test 7: AI Disclaimer on Profile View**
```
‚úÖ Steps:
1. After profile loads, look at the top of profile section

‚úÖ Expected:
- Blue box with info icon (‚ÑπÔ∏è)
- Text: "Profile auto-generated by AI. Verify and edit if needed."
```

---

### **Test 8: Edit Profile - Can Edit All Fields** üÜï
```
‚úÖ Steps:
1. Click Edit icon (pencil) on profile

‚úÖ Expected - AI DISCLAIMER IN EDIT MODE:
- Yellow box appears
- Text: "AI-extracted data. Please verify accuracy before saving."

2. Check ALL editable fields are present:
   ‚ñ° Skills (textarea)
   ‚ñ° Experience (large textarea, 5 rows)
   ‚ñ° Years of Experience (text input) üÜï THIS WAS MISSING BEFORE
   ‚ñ° Education (textarea, 3 rows) üÜï THIS WAS MISSING BEFORE

3. Make changes to any field
4. Click "Save Changes"

‚úÖ Expected:
- Message: "Profile updated successfully!"
- Exit edit mode automatically
- Changes reflected in view mode
- Blue "Calculating match scores" banner appears (recalculating)
```

---

### **Test 9: Job Listing - Match Scores Calculation** ‚≠ê CRITICAL
```
‚úÖ Steps:
1. Look at Available Jobs section (right side)

‚úÖ Expected - WHILE CALCULATING:
- Blue banner: "Calculating match scores... Please wait."
- Jobs visible but scores may be loading

‚úÖ Expected - AFTER CALCULATION (30-60 seconds max):
- Blue banner disappears
- Each job shows:
  ‚ñ° Match percentage (0-100%) in colored number
  ‚ñ° Color coding:
    - Green (80%+): Excellent Match
    - Yellow (60-79%): Good Match
    - Orange (40-59%): Fair Match
    - Red (0-39%): Low Match
  ‚ñ° Progress bar below job details
  ‚ñ° "Eligibility Score" label

‚úÖ VERIFY:
- Jobs should be SORTED by match score (highest first)
- Top job should have highest percentage
- Scores should make sense based on your resume
```

---

### **Test 10: Apply Without Profile (Should Block)** üÜï
```
‚úÖ Steps:
1. Logout
2. Create NEW account (different email)
3. Verify email
4. Login
5. DON'T upload resume
6. Look at job Apply buttons

‚úÖ Expected:
- All Apply buttons are GRAY and DISABLED
- Button text: "Upload Resume First"
- Upload icon visible on button

7. Try clicking Apply button

‚úÖ Expected:
- Button doesn't respond (disabled)
- OR alert: "Please upload your resume before applying to jobs."
```

---

### **Test 11: Apply to Job - Status Updates Immediately** ‚≠ê CRITICAL FIX
```
‚úÖ Steps:
1. With profile uploaded, find a job
2. Click "Apply Now"

‚úÖ Expected - IMMEDIATELY (within 1-2 seconds):
- Alert: "Application submitted successfully!"
- Button changes to:
  - Text: "Applied"
  - Gray color
  - Checkmark icon
  - Disabled state

‚úÖ THIS IS THE FIX:
Before: Button stayed "Apply Now" for 10+ minutes ‚ùå
After: Button changes to "Applied" instantly ‚úÖ

3. Refresh the page
4. Check same job

‚úÖ Expected:
- Still shows "Applied"
- Can't apply again
```

---

### **Test 12: Duplicate Application Prevention** üÜï
```
‚úÖ Steps:
1. Find a job you already applied to
2. Open browser DevTools (F12)
3. Go to Console tab
4. Try clicking "Applied" button (even though disabled)
5. OR manually try to POST application via API

‚úÖ Expected:
- Button stays disabled
- If API called directly: Error "Application already exists"
- No duplicate entries in database
```

---

### **Test 13: Match Scores Stay Consistent** ‚≠ê CRITICAL FIX
```
‚úÖ Steps:
1. Note down match scores for top 3 jobs
   Example: Job A: 85%, Job B: 72%, Job C: 68%

2. Logout
3. Login again
4. Check same jobs

‚úÖ Expected:
- Scores should be SAME or very close (¬±2%)
- Job A should still be ~85%
- Order should remain same

‚úÖ THIS IS THE FIX:
Before: Scores changed drastically on re-login ‚ùå
After: Scores cached and consistent ‚úÖ

5. Close browser completely
6. Open new browser window
7. Login again

‚úÖ Expected:
- Scores still consistent (cached in sessionStorage)
```

---

### **Test 14: Profile Missing After Refresh** ‚≠ê CRITICAL FIX
```
‚úÖ Steps:
1. After uploading resume and profile showing
2. Hard refresh page (Ctrl + Shift + R)

‚úÖ Expected - NO ERROR:
- Shows "Loading profile..." with spinner
- Profile loads within 5 seconds
- All data displays correctly

‚úÖ If profile fails to load:
- Shows red error box:
  "Unable to load profile. Please refresh the page."
- Has "Retry" button
- Clicking retry attempts to reload

‚úÖ THIS IS THE FIX:
Before: Profile disappeared, blank screen ‚ùå
After: Retry logic with 3 attempts, clear error message ‚úÖ

3. Disconnect internet briefly
4. Refresh page

‚úÖ Expected:
- Shows loading, then error after 3 retries
- Error message is clear
- Retry button works
```

---

## **PART 2: ADMIN PORTAL TESTING** üë®‚Äçüíº

### **Test 15: Admin Login**
```
‚úÖ Steps:
1. Go to http://localhost:5174
2. Enter admin email (from .env: ADMIN_EMAIL)
3. Enter admin password (from .env: ADMIN_PASSWORD)
4. Click "Continue"

‚úÖ Expected:
- Message: "OTP sent to your email"
- Step changes to OTP entry

5. Check email for OTP
6. Enter OTP
7. Click "Verify & Login"

‚úÖ Expected:
- Logs in successfully
- Redirects to admin dashboard
- If super admin: Shows red "Super Admin" badge
```

---

### **Test 16: Admin Forgot Password** üÜï
```
‚úÖ Steps:
1. Go to admin login
2. Click "Forgot password?"

‚úÖ Expected:
- Purple/pink theme (not blue like candidate)
- Shows "Admin Password Reset" heading
- KeyRound icon visible

3. Enter admin email
4. Click "Send Reset Code"
5. Check email for OTP
6. Enter OTP and new password
7. Click "Reset Password"

‚úÖ Expected:
- Success message
- Auto-redirects to login
- Can login with new password
```

---

### **Test 17: Create Job Posting**
```
‚úÖ Steps:
1. In admin dashboard, go to "Job Postings" tab
2. Click "New Job"

‚úÖ Expected:
- Form expands with fields:
  ‚ñ° Job Title
  ‚ñ° Company
  ‚ñ° Role
  ‚ñ° Salary (CTC)
  ‚ñ° Description
  ‚ñ° Requirements (optional)

3. Fill all required fields
4. Click "Create Job"

‚úÖ Expected:
- Alert: "Job posted successfully!"
- Form closes
- New job appears in list
- If super admin: Shows "Posted by: Your Name (your@email.com)"
- If regular admin: Shows "Posted by: Admin"
```

---

### **Test 18: Applications Tab - No Duplicates** ‚≠ê CRITICAL FIX
```
‚úÖ Steps:
1. Go to "Applications" tab
2. Look for any candidate who applied to same job

‚úÖ Expected - NO DUPLICATES:
- Each candidate appears ONCE per job
- If "John Doe" applied to "Software Engineer", only ONE entry
- No repeated entries

‚úÖ THIS IS THE FIX:
Before: Same application appeared 2-3 times ‚ùå
After: Unique constraint prevents duplicates ‚úÖ
```

---

### **Test 19: Applications Sorted by Score** üÜï
```
‚úÖ Steps:
1. Look at applications list
2. Check match score percentages

‚úÖ Expected - SORTED HIGH TO LOW:
- First application should have highest score
- Example order:
  1. Candidate A - 92%
  2. Candidate B - 85%
  3. Candidate C - 78%
  4. Candidate D - 45%

‚úÖ THIS IS THE FIX:
Before: Random order ‚ùå
After: Sorted by match score (best candidates first) ‚úÖ
```

---

### **Test 20: Admin Data Separation (Non-Super Admin)**
```
‚úÖ Steps:
1. Create a second admin account (if super admin)
   - Use "Manage Admins" tab
   - Create new admin with different email

2. Logout
3. Login with NEW admin credentials
4. Create a job as this new admin
5. Go to "Applications" tab

‚úÖ Expected:
- Only sees applications for THEIR jobs
- Does NOT see applications for other admins' jobs

6. Go to "Job Postings" tab

‚úÖ Expected:
- Only sees THEIR job postings
- Does NOT see super admin's jobs

‚úÖ THIS WAS ALREADY WORKING (confirmed)
```

---

### **Test 21: Super Admin - Sees Everything**
```
‚úÖ Steps:
1. Login as super admin (ADMIN_EMAIL from .env)
2. Check red "Super Admin" badge is visible

3. Go to "Job Postings"

‚úÖ Expected:
- Sees ALL jobs from ALL admins
- Each job shows "Posted by: [Admin Name] ([email])"

4. Go to "Applications"

‚úÖ Expected:
- Sees ALL applications for ALL jobs
- Each application shows:
  - Candidate info
  - Job title
  - "Job posted by: [Admin Name]"

5. Check "Manage Admins" tab exists

‚úÖ Expected:
- Tab visible ONLY for super admin
- Can create new admins
- Lists all current admins
```

---

### **Test 22: Candidates with Resumes Tab**
```
‚úÖ Steps:
1. Go to "Candidates w/ Resumes" tab

‚úÖ Expected - Table with columns:
- Name
- Email  
- Registered On (date)
- Resume (clickable link)

2. Click "View" link on Resume column

‚úÖ Expected:
- Opens Cloudinary PDF link in new tab
- PDF displays correctly
- OR downloads PDF file
```

---

### **Test 23: Semantic Search**
```
‚úÖ Steps:
1. Go to "Semantic Search" tab
2. Enter query: "python developer with 5 years experience"
3. Click search button

‚úÖ Expected - WHILE SEARCHING:
- Shows loading spinner
- Text: "Searching..."

‚úÖ Expected - AFTER SEARCH (10-30 seconds):
- Shows matching candidates
- Each result shows:
  ‚ñ° Name & Email
  ‚ñ° Skills
  ‚ñ° Experience preview
  ‚ñ° Education
  ‚ñ° Years of experience
  ‚ñ° Final Score (0-100%)
  ‚ñ° Vector Score (similarity)
  ‚ñ° AI Relevancy Score
  ‚ñ° Two progress bars (vector and AI)

‚úÖ VERIFY:
- Results sorted by Final Score (highest first)
- Scores make sense for query
- Can click "View Resume" to see full resume
```

---

## **PART 3: EDGE CASES & ERROR SCENARIOS** ‚ö†Ô∏è

### **Test 24: Upload Invalid File**
```
‚úÖ Steps:
1. Try uploading .txt file
2. Try uploading .jpg image
3. Try uploading .xlsx file

‚úÖ Expected:
- File picker only allows .pdf and .docx
- OR shows error: "Unsupported file format"
```

---

### **Test 25: Upload Empty/Corrupted Resume**
```
‚úÖ Steps:
1. Create blank PDF
2. Try uploading

‚úÖ Expected:
- Error: "Could not extract meaningful text from resume"
- Profile NOT created
- Stay on upload screen
```

---

### **Test 26: Network Error Handling**
```
‚úÖ Steps:
1. Start uploading resume
2. Disconnect internet mid-upload

‚úÖ Expected:
- Shows error message
- Upload button re-enables
- Can retry

3. With profile loaded, disconnect internet
4. Try applying to job

‚úÖ Expected:
- Error alert: "Error applying to job"
- Button stays as "Apply Now"
- Can retry when online
```

---

### **Test 27: Session Timeout**
```
‚úÖ Steps:
1. Login
2. Wait 7+ days (or manually clear localStorage)
3. Try any action

‚úÖ Expected:
- Redirects to login
- Message: "Not authorized" or "Session expired"
```

---

### **Test 28: Concurrent Applications**
```
‚úÖ Steps:
1. Open 2 browser windows side-by-side
2. Login to same account in both
3. Apply to same job from BOTH windows simultaneously

‚úÖ Expected:
- First application succeeds
- Second application shows error:
  "Already applied to this job" OR "Application already exists"
- Database has only ONE application entry
```

---

## **PART 4: PERFORMANCE CHECKS** ‚ö°

### **Test 29: Speed Tests**
```
‚úÖ Measure these timings:

1. Resume Upload ‚Üí Profile Display: _______ seconds
   ‚úÖ Should be: < 30 seconds

2. Click Apply ‚Üí Button changes to "Applied": _______ seconds
   ‚úÖ Should be: < 2 seconds (CRITICAL FIX)

3. Login ‚Üí Dashboard loads: _______ seconds
   ‚úÖ Should be: < 3 seconds

4. Job match score calculation (all jobs): _______ seconds
   ‚úÖ Should be: < 60 seconds for 10 jobs

5. Semantic search results: _______ seconds
   ‚úÖ Should be: < 30 seconds
```

---

### **Test 30: Check Browser Console for Errors**
```
‚úÖ Steps:
1. Open DevTools (F12) ‚Üí Console tab
2. Perform all actions on candidate portal

‚úÖ Expected:
- No RED errors
- Yellow warnings are OK
- Should see logs like:
  "[SERVER] POST /api/jobs/123/apply"
  "[SERVER-INFO] Application created"

3. Check Network tab

‚úÖ Expected:
- All API calls return 200/201
- No 500 errors
- No failed requests (except intentional tests)
```

---

## **FINAL VERIFICATION CHECKLIST** ‚úÖ

Print this and check off each item:

### **Candidate Portal:**
- [ ] Signup with email verification works
- [ ] Login works
- [ ] **Forgot password works (NEW)**
- [ ] Resume upload succeeds
- [ ] **OCR extracts skills correctly**
- [ ] **OCR extracts experience correctly**
- [ ] **OCR extracts education correctly**
- [ ] **OCR extracts years of experience correctly**
- [ ] **AI disclaimer visible (3 places)**
- [ ] **Can edit all fields including years & education (NEW)**
- [ ] **Match scores calculated and displayed**
- [ ] **Jobs sorted by match score**
- [ ] **Apply button changes to "Applied" IMMEDIATELY (CRITICAL FIX)**
- [ ] **Can't apply without profile - shows message (NEW)**
- [ ] **No duplicate applications possible (NEW)**
- [ ] **Match scores consistent after re-login (CRITICAL FIX)**
- [ ] **Profile loads after refresh with retry logic (CRITICAL FIX)**

### **Admin Portal:**
- [ ] Admin login with OTP works
- [ ] **Admin forgot password works (NEW)**
- [ ] Can create job postings
- [ ] **Applications tab shows no duplicates (CRITICAL FIX)**
- [ ] **Applications sorted by match score (NEW)**
- [ ] Non-super admin only sees their jobs/applications
- [ ] Super admin sees all jobs/applications
- [ ] Super admin can create new admins
- [ ] Candidates with Resumes tab works
- [ ] Can view resume PDFs
- [ ] Semantic search returns relevant results

### **System:**
- [ ] No console errors
- [ ] All API calls succeed
- [ ] Performance is acceptable
- [ ] Error messages are clear
- [ ] UI is responsive

---

## **If ANY Test Fails:** üêõ

1. **Note which test failed**
2. **Check browser console for errors**
3. **Check backend logs:**
   - Python service terminal
   - Node server terminal
4. **Check .env file has all required variables**
5. **Verify MongoDB is running and connected**
6. **Clear browser cache and sessionStorage**
7. **Try in incognito/private window**

---

## **Quick Smoke Test (5 Minutes):** üöÄ

If you want to quickly verify everything works:
```
1. ‚úÖ Candidate: Signup ‚Üí Upload resume ‚Üí Apply to job ‚Üí Check "Applied" instantly
2. ‚úÖ Admin: Login ‚Üí Check applications sorted by score
3. ‚úÖ Test forgot password on both portals
4. ‚úÖ Edit profile - verify years & education fields present
5. ‚úÖ Check no duplicate applications
6. ‚úÖ Verify match scores consistent after re-login